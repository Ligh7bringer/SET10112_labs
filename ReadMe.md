##### Maths stuff!
Should be mostly done in Python but I might change my mind halfway through.